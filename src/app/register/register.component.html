<div class="container center-container register-form" mat-dialog-content>

  <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
    <div class="form-group" >

      <!-- Username entry -->
      <mat-form-field #username
                      class="w-100 form-font mb-2"
                      appearance="outline"
                      color="accent">

        <mat-label class="text-light">
          Username
        </mat-label>

        <input matInput
               class="text-light"
               formControlName="username">

        @if (registerForm.get('username')?.invalid && (registerForm.get('username')?.touched || registerForm.get('username')?.dirty)) {
          <mat-error>{{ usernameErrorMessage() }}</mat-error>
        }
      </mat-form-field>

      <!-- Email entry -->
      <mat-form-field #email
                      class="w-100 form-font mb-2"
                      appearance="outline"
                      color="accent">
        <mat-label class="text-light">
          Email address
        </mat-label>

        <input matInput class="text-light"
               formControlName="email">

        @if (registerForm.get('email')?.invalid && (registerForm.get('email')?.touched || registerForm.get('email')?.dirty)) {
          <mat-error>{{emailErrorMessage()}}</mat-error>
        }
      </mat-form-field>

      <!-- Password entry -->
      <mat-form-field #password
                      class="w-100 form-font mb-2"
                      appearance="outline"
                      color="accent">

        <mat-label class="text-light">
          Password
        </mat-label>

        <input matInput
               class="text-light"
               [type]="showPassword ? 'text' : 'password'"
               formControlName="password">

        <button type="button"
                mat-icon-button
                matSuffix
                (click)="showPassword = !showPassword"
                [attr.aria-label]="'Toggle password visibility'"
                [attr.aria-pressed]="showPassword">
          <mat-icon>{{ showPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>

        @if (registerForm.get('password')?.invalid && (registerForm.get('password')?.touched || registerForm.get('password')?.dirty)) {
          <mat-error>{{passwordErrorMessage()}}</mat-error>
        }
      </mat-form-field>

      <!-- First name entry -->
      <mat-form-field #firstname
                      class="w-100 form-font mb-2"
                      appearance="outline"
                      color="accent">

        <mat-label class="text-light">
          First name
        </mat-label>

        <input matInput class="text-light"
               formControlName="firstName">

        @if (registerForm.get('firstName')?.invalid && (registerForm.get('firstName')?.touched || registerForm.get('firstName')?.dirty)) {
          <mat-error>{{firstNameErrorMessage()}}</mat-error>
        }
      </mat-form-field>

      <!-- Last name entry -->
      <mat-form-field #lastname
                      class="w-100 form-font mb-2"
                      appearance="outline"
                      color="accent">

        <mat-label class="text-light">
          Last name
        </mat-label>

        <input matInput class="text-light"
               formControlName="lastName">

        @if (registerForm.get('lastName')?.invalid && (registerForm.get('lastName')?.touched || registerForm.get('lastName')?.dirty)) {
          <mat-error>{{lastNameErrorMessage()}}</mat-error>
        }
      </mat-form-field>

    </div>

    <div *ngIf="generalErrorMessage()" class="mb-2 d-flex align-items-center gap-2">
      <mat-error class="fst-italic">
        {{generalErrorMessage()}}
      </mat-error>
    </div>

    <div *ngIf="successMessage()" class="mb-2 d-flex align-items-center gap-2">
      <span class="text-success fst-italic">
        {{ successMessage() }}
      </span>
    </div>

    <div>
      <button mat-raised-button
              [disabled]="registerForm.get('email')?.value === ''"
              color="warn w-100"
              class="button-bg text-light">
        Create your account
      </button>
    </div>

    <br>

    <div class="text-start">
      <span class="text-light"><a routerLink="/passwordrecovery">Forgot your password?</a></span>
    </div>

    <hr class="border-light">

    <div class="text-light text-center">
      <span class="text-light">Already have an account? <a routerLink="/login">Login here!</a></span>
    </div>
  </form>

</div>
